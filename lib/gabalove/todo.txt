[ ] Refactor viewport into viewport manager